<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Rooster Kombat</title>

<style>
body {
    margin: 0;
    background: radial-gradient(circle, #111, #3a6073);
    color: white;
    font-family: Arial, sans-serif;
    text-align: center;
    overflow: hidden;
}

body.strobe {
    animation: strobe 0.15s alternate 6;
}
@keyframes strobe {
    from { background: white; }
    to { background: black; }
}

h1 { margin: 10px; }

.arena {
    position: relative;
    width: 95%;
    height: 360px;
    margin: 20px auto 80px;
    border-bottom: 4px solid #fff;
    overflow: hidden;
}

.rooster {
    position: absolute;
    bottom: 0;
    font-size: 80px;
    user-select: none;
    transition: transform 0.15s;
}

.red { filter: hue-rotate(0deg) saturate(2); }
.blue { filter: hue-rotate(200deg) saturate(2); }

/* JUMP */
.jump {
    animation: jump 0.45s ease-out;
}
@keyframes jump {
    0% { bottom: 0; }
    50% { bottom: 140px; }
    100% { bottom: 0; }
}

/* DUCK */
.duck {
    transform: scaleY(0.6);
}

/* KNIFE */
.knife {
    position: absolute;
    font-size: 30px;
    animation: spin 0.3s linear infinite;
}
@keyframes spin { to { transform: rotate(360deg); } }

.knife.fire {
    color: orange;
    text-shadow: 0 0 10px red, 0 0 20px orange;
}
.knife.lightning {
    color: cyan;
    text-shadow: 0 0 10px cyan, 0 0 20px white;
}

/* FEATHER */
.feather {
    position: absolute;
    font-size: 20px;
    animation: featherFall 1s forwards;
}
@keyframes featherFall {
    to { transform: translateY(80px) rotate(360deg); opacity: 0; }
}

/* SHOCKWAVE */
.shockwave {
    position: absolute;
    width: 20px;
    height: 20px;
    border: 3px solid white;
    border-radius: 50%;
    animation: shock 0.6s ease-out forwards;
}
@keyframes shock {
    to { transform: scale(8); opacity: 0; }
}

/* CONFETTI */
.confetti {
    position: absolute;
    width: 8px;
    height: 14px;
    animation: fall 3s linear forwards;
}
@keyframes fall {
    to { transform: translateY(600px) rotate(720deg); opacity: 0; }
}

/* HEALTH */
.health-bar {
    width: 200px;
    height: 16px;
    border: 2px solid #fff;
    margin: 6px auto;
    background: #333;
}
.health { height: 100%; background: limegreen; }

/* WIN */
#winner {
    position: fixed;
    inset: 0;
    display: none;
    align-items: center;
    justify-content: center;
    font-size: 64px;
    background: rgba(0,0,0,0.6);
    z-index: 999;
}

/* CONTROLS HUD */
.controls {
    position: fixed;
    bottom: 0;
    width: 100%;
    background: rgba(0,0,0,0.75);
    padding: 10px;
    font-size: 14px;
    display: flex;
    justify-content: space-around;
    z-index: 100;
}
</style>
</head>

<body>

<h1>üêì ROOSTER KOMBAT üî•‚ö°</h1>

<div class="arena" id="arena">
    <div id="r1" class="rooster red">üêì</div>
    <div id="r2" class="rooster blue">üêì</div>
</div>

<div class="health-bar"><div id="h1" class="health"></div></div>
<div class="health-bar"><div id="h2" class="health"></div></div>

<div id="winner"></div>

<div class="controls">
    üî¥ A/D Move ¬∑ W Jump ¬∑ S Duck ¬∑ F Fire  
    üîµ ‚Üê/‚Üí Move ¬∑ ‚Üë Jump ¬∑ ‚Üì Duck ¬∑ Enter Fire
</div>

<audio id="bgm" loop src="https://assets.mixkit.co/music/preview/mixkit-epic-dark-fight-1230.mp3"></audio>
<audio id="throw" src="https://assets.mixkit.co/sfx/preview/mixkit-fast-sword-whoosh-2792.mp3"></audio>
<audio id="hit" src="https://assets.mixkit.co/sfx/preview/mixkit-knife-stab-2084.mp3"></audio>
<audio id="clap" src="https://assets.mixkit.co/sfx/preview/mixkit-audience-clapping-strong-476.mp3"></audio>

<script>
const arena = document.getElementById("arena");
const r1 = document.getElementById("r1");
const r2 = document.getElementById("r2");
const h1 = document.getElementById("h1");
const h2 = document.getElementById("h2");
const winnerBox = document.getElementById("winner");

let pos1 = 60, pos2 = arena.offsetWidth - 140;
let hits1 = 0, hits2 = 0;
let combo1 = 0, combo2 = 0;
const MAX_HITS = 100;

let jumping1 = false, jumping2 = false;
let ducking1 = false, ducking2 = false;

let gameOver = false, started = false;
const keys = {};

document.addEventListener("keydown", e => {
    keys[e.key] = true;
    if (!started) {
        document.getElementById("bgm").play();
        started = true;
    }
    if (gameOver) return;

    if (e.key === "w" && !jumping1) jump(r1, 1);
    if (e.key === "ArrowUp" && !jumping2) jump(r2, 2);

    if (e.key === "f") throwKnife(true);
    if (e.key === "Enter") throwKnife(false);
});

document.addEventListener("keyup", e => {
    keys[e.key] = false;
    if (e.key === "s") { ducking1 = false; r1.classList.remove("duck"); }
    if (e.key === "ArrowDown") { ducking2 = false; r2.classList.remove("duck"); }
});

function jump(r, n) {
    r.classList.add("jump");
    n === 1 ? jumping1 = true : jumping2 = true;
    setTimeout(() => {
        r.classList.remove("jump");
        n === 1 ? jumping1 = false : jumping2 = false;
    }, 450);
}

function faceEachOther() {
    r1.style.transform = pos1 < pos2 ? "scaleX(-1)" : "scaleX(1)";
    r2.style.transform = pos2 < pos1 ? "scaleX(-1)" : "scaleX(1)";
}

/* üó°Ô∏è BELLY-LEVEL PROJECTILE */
function getBellyHeight(rooster, ducking) {
    const h = rooster.offsetHeight;
    return ducking ? h * 0.3 : h * 0.5;
}

function throwKnife(isRed) {
    document.getElementById("throw").play();

    const element = Math.random() < 0.5 ? "fire" : "lightning";
    const knife = document.createElement("div");
    knife.className = `knife ${element}`;
    knife.textContent = "üó°Ô∏è";

    const shooter = isRed ? r1 : r2;
    const shooterPos = isRed ? pos1 : pos2;
    const targetPos = isRed ? pos2 : pos1;

    let x = shooterPos + 40;
    let dir = Math.sign(targetPos - x);

    const bellyHeight = getBellyHeight(shooter, isRed ? ducking1 : ducking2);

    knife.style.left = x + "px";
    knife.style.bottom = bellyHeight + "px";
    arena.appendChild(knife);

    const move = setInterval(() => {
        x += dir * 10;
        knife.style.left = x + "px";

        const targetJumping = isRed ? jumping2 : jumping1;

        if (Math.abs(x - targetPos) < 40 && !targetJumping) {
            knife.remove();
            clearInterval(move);
            registerHit(isRed);
        }

        if (x < -50 || x > arena.offsetWidth + 50) {
            knife.remove();
            clearInterval(move);
        }
    }, 30);
}

function registerHit(isRed) {
    document.getElementById("hit").play();
    if (isRed) {
        hits2++; combo2++; combo1 = 0;
        feathers(r2);
        if (combo2 === 3) shock(r2);
    } else {
        hits1++; combo1++; combo2 = 0;
        feathers(r1);
        if (combo1 === 3) shock(r1);
    }
    updateHealth();
    checkWin();
}

function feathers(target) {
    for (let i = 0; i < 5; i++) {
        const f = document.createElement("div");
        f.className = "feather";
        f.textContent = "ü™∂";
        f.style.left = Math.random() * 40 + "px";
        f.style.bottom = "80px";
        target.appendChild(f);
        setTimeout(() => f.remove(), 1000);
    }
}

function shock(target) {
    document.body.classList.add("strobe");
    setTimeout(() => document.body.classList.remove("strobe"), 900);
    const s = document.createElement("div");
    s.className = "shockwave";
    s.style.left = target.offsetLeft + 40 + "px";
    s.style.bottom = "80px";
    arena.appendChild(s);
    setTimeout(() => s.remove(), 600);
}

function updateHealth() {
    h1.style.width = ((MAX_HITS - hits1) / MAX_HITS) * 100 + "%";
    h2.style.width = ((MAX_HITS - hits2) / MAX_HITS) * 100 + "%";
}

function checkWin() {
    if (hits1 >= MAX_HITS || hits2 >= MAX_HITS) {
        gameOver = true;
        document.getElementById("bgm").pause();
        document.getElementById("clap").play();
        winnerBox.style.display = "flex";
        winnerBox.textContent =
            hits1 >= MAX_HITS ? "üèÜ BLUE ROOSTER WINS!" : "üèÜ RED ROOSTER WINS!";
        confetti();
    }
}

function confetti() {
    for (let i = 0; i < 150; i++) {
        const c = document.createElement("div");
        c.className = "confetti";
        c.style.left = Math.random() * window.innerWidth + "px";
        c.style.top = "-20px";
        c.style.background = `hsl(${Math.random()*360},100%,50%)`;
        document.body.appendChild(c);
        setTimeout(() => c.remove(), 3000);
    }
}

function update() {
    if (!gameOver) {
        if (keys["a"]) pos1 -= 4;
        if (keys["d"]) pos1 += 4;
        if (keys["ArrowLeft"]) pos2 -= 4;
        if (keys["ArrowRight"]) pos2 += 4;

        if (keys["s"]) { ducking1 = true; r1.classList.add("duck"); }
        if (keys["ArrowDown"]) { ducking2 = true; r2.classList.add("duck"); }

        pos1 = Math.max(0, Math.min(pos1, arena.offsetWidth - 80));
        pos2 = Math.max(0, Math.min(pos2, arena.offsetWidth - 80));

        r1.style.left = pos1 + "px";
        r2.style.left = pos2 + "px";
        faceEachOther();
    }
    requestAnimationFrame(update);
}
update();
</script>

</body>
</html>
